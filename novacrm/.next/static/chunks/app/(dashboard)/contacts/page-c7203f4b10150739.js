(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3094],{27395:(e,s,t)=>{Promise.resolve().then(t.bind(t,38887))},38887:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>O});var a=t(95155),l=t(12115),n=t(66716),r=t(57218),c=t(88661),d=t.n(c),i=t(43569),o=t(6956),x=t(88125),m=t(29632),p=t(89731),b=t(9554),u=t(15233);function h(e){let{firstName:s,lastName:t,size:l="md"}=e,n="".concat(s.charAt(0)).concat(t.charAt(0)).toUpperCase(),r=["#89b4fa","#74c7ec","#94e2d5","#b4befe","#f5c2e7","#f38ba8","#fab387","#f9e2af","#a6e3a1"],c=(s.charCodeAt(0)+t.charCodeAt(0))%r.length,d=r[c];return(0,a.jsx)("div",{className:"".concat({sm:"h-8 w-8 text-xs",md:"h-10 w-10 text-sm",lg:"h-12 w-12 text-base"}[l]," flex items-center justify-center rounded-md font-bold text-[#1e1e2e]"),style:{backgroundColor:d},children:n})}function f(e){let{campaigns:s}=e,t=["#89b4fa","#74c7ec","#94e2d5","#b4befe"];return s&&0!==s.length?(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:s.map((e,s)=>{let l=t[s%t.length];return(0,a.jsx)("span",{className:"rounded-md px-2 py-1 text-xs font-semibold text-[#1e1e2e]",style:{backgroundColor:l},children:e.campaign.name},e.campaign.id)})}):(0,a.jsx)("span",{className:"text-sm text-[#6c7086]",children:"—"})}var j=t(70343);function g(e){let{contactId:s,contactName:t,contactCompany:n,isOpen:c,onClose:d,onDealCreated:o}=e,{showToast:x}=(0,j.d)(),[m,p]=(0,l.useState)(!1),[b,u]=(0,l.useState)([]),[h,f]=(0,l.useState)(!0),[g,N]=(0,l.useState)(""),[v,y]=(0,l.useState)(""),[w,C]=(0,l.useState)(50),[k,_]=(0,l.useState)(""),[F,S]=(0,l.useState)(""),[A,D]=(0,l.useState)(""),[L,I]=(0,l.useState)({});(0,l.useEffect)(()=>{c&&E()},[c]);let E=async()=>{try{f(!0);let e=await fetch("/api/pipeline-stages");if(!e.ok)throw Error("Failed to fetch pipeline stages");let s=await e.json();u(s.stages),s.stages.length>0&&_(s.stages[0].id)}catch(e){console.error("Error fetching stages:",e),x("Failed to load pipeline stages","error")}finally{f(!1)}},U=async()=>{if((()=>{let e={};if(g.trim()?g.length>200&&(e.title="Deal title must be 200 characters or less"):e.title="Deal title is required",v){let s=parseFloat(v);isNaN(s)||s<0?e.value="Value must be a positive number":s>99999999.99&&(e.value="Value must be less than $99,999,999.99")}if((w<0||w>100)&&(e.probability="Probability must be between 0 and 100"),k||(e.stageId="Please select a pipeline stage"),F){let s=new Date(F),t=new Date;t.setHours(0,0,0,0),s<t&&(e.expectedCloseDate="Close date cannot be in the past")}return A&&A.length>2e3&&(e.notes="Notes must be 2000 characters or less"),I(e),0===Object.keys(e).length})())try{p(!0);let e={contact_id:s,title:g.trim(),value:v?parseFloat(v):null,probability:w||null,stage_id:k,expected_close_date:F||null,notes:A.trim()||null},t=await fetch("/api/deals",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to create deal")}x("Deal created successfully","success"),O(),o()}catch(e){console.error("Error creating deal:",e),x(e.message||"Failed to create deal. Please try again.","error")}finally{p(!1)}},O=()=>{var e;N(""),y(""),C(50),_((null==(e=b[0])?void 0:e.id)||""),S(""),D(""),I({}),d()};return c?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 z-40 bg-black/70",onClick:e=>{e.target===e.currentTarget&&(g||v||A?confirm("You have unsaved changes. Are you sure you want to close?")&&O():O())}}),(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"relative w-full max-w-2xl max-h-[90vh] overflow-hidden rounded-2xl border border-[#313244] bg-[#1e1e2e] shadow-2xl",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between border-b border-[#313244] px-6 py-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-[#cdd6f4]",children:"Create New Deal"}),(0,a.jsx)("button",{onClick:O,className:"rounded-lg p-1 text-[#a6adc8] transition-colors hover:bg-[#313244] hover:text-[#cdd6f4]",children:(0,a.jsx)(i.A,{className:"h-6 w-6"})})]}),(0,a.jsx)("div",{className:"overflow-y-auto p-6",style:{maxHeight:"calc(90vh - 140px)"},children:h?(0,a.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,a.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-[#313244] border-t-[#F25C05]"})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-2 text-sm font-medium text-[#a6adc8]",children:"For:"}),(0,a.jsxs)("p",{className:"text-base text-[#cdd6f4]",children:[t,n&&(0,a.jsxs)("span",{className:"text-[#a6adc8]",children:[" (",n,")"]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block mb-2 text-sm font-medium text-[#cdd6f4]",children:["Deal Title ",(0,a.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,a.jsx)("input",{type:"text",value:g,onChange:e=>N(e.target.value),placeholder:"e.g., Q1 Enterprise License",maxLength:200,className:"w-full rounded-lg border border-[#313244] bg-[#181825] px-4 py-2 text-[#cdd6f4] placeholder-[#6c7086] focus:border-[#F25C05] focus:outline-none focus:ring-1 focus:ring-[#F25C05]"}),(0,a.jsxs)("div",{className:"mt-1 flex justify-between",children:[L.title&&(0,a.jsx)("p",{className:"text-xs text-red-400",children:L.title}),(0,a.jsxs)("span",{className:"ml-auto text-xs text-[#6c7086]",children:[g.length,"/200"]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-2 text-sm font-medium text-[#cdd6f4]",children:"Deal Value ($)"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-[#a6adc8]",children:"$"}),(0,a.jsx)("input",{type:"text",value:v,onChange:e=>y(e.target.value.replace(/[^0-9.]/g,"")),placeholder:"0.00",className:"w-full rounded-lg border border-[#313244] bg-[#181825] pl-8 pr-4 py-2 text-[#cdd6f4] placeholder-[#6c7086] focus:border-[#F25C05] focus:outline-none focus:ring-1 focus:ring-[#F25C05]"})]}),L.value&&(0,a.jsx)("p",{className:"mt-1 text-xs text-red-400",children:L.value})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-2 text-sm font-medium text-[#cdd6f4]",children:"Win Probability (%)"}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("input",{type:"range",min:"0",max:"100",step:"5",value:w,onChange:e=>C(parseInt(e.target.value)),className:"flex-1"}),(0,a.jsx)("input",{type:"number",min:"0",max:"100",value:w,onChange:e=>C(Math.min(100,Math.max(0,parseInt(e.target.value)||0))),className:"w-20 rounded-lg border border-[#313244] bg-[#181825] px-3 py-2 text-center text-[#cdd6f4] focus:border-[#F25C05] focus:outline-none focus:ring-1 focus:ring-[#F25C05]"}),(0,a.jsx)("span",{className:"text-[#a6adc8]",children:"%"})]}),L.probability&&(0,a.jsx)("p",{className:"mt-1 text-xs text-red-400",children:L.probability})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block mb-2 text-sm font-medium text-[#cdd6f4]",children:["Pipeline Stage ",(0,a.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,a.jsx)("select",{value:k,onChange:e=>_(e.target.value),className:"w-full rounded-lg border border-[#313244] bg-[#181825] px-4 py-2 text-[#cdd6f4] focus:border-[#F25C05] focus:outline-none focus:ring-1 focus:ring-[#F25C05]",children:b.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.order_num,". ",e.name]},e.id))}),L.stageId&&(0,a.jsx)("p",{className:"mt-1 text-xs text-red-400",children:L.stageId})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-2 text-sm font-medium text-[#cdd6f4]",children:"Expected Close Date"}),(0,a.jsx)("input",{type:"date",value:F,onChange:e=>S(e.target.value),min:new Date().toISOString().split("T")[0],className:"w-full rounded-lg border border-[#313244] bg-[#181825] px-4 py-2 text-[#cdd6f4] focus:border-[#F25C05] focus:outline-none focus:ring-1 focus:ring-[#F25C05]"}),L.expectedCloseDate&&(0,a.jsx)("p",{className:"mt-1 text-xs text-red-400",children:L.expectedCloseDate})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-2 text-sm font-medium text-[#cdd6f4]",children:"Notes"}),(0,a.jsx)("textarea",{value:A,onChange:e=>D(e.target.value),placeholder:"Add context, next steps, or important details...",rows:4,maxLength:2e3,className:"w-full rounded-lg border border-[#313244] bg-[#181825] px-4 py-2 text-[#cdd6f4] placeholder-[#6c7086] focus:border-[#F25C05] focus:outline-none focus:ring-1 focus:ring-[#F25C05] resize-none"}),(0,a.jsx)("div",{className:"mt-1 flex justify-end",children:(0,a.jsxs)("span",{className:"text-xs text-[#6c7086]",children:[A.length,"/2000"]})}),L.notes&&(0,a.jsx)("p",{className:"mt-1 text-xs text-red-400",children:L.notes})]})]})}),(0,a.jsxs)("div",{className:"flex items-center justify-end gap-3 border-t border-[#313244] px-6 py-4",children:[(0,a.jsx)("button",{onClick:O,disabled:m,className:"rounded-lg border border-[#313244] bg-transparent px-4 py-2 text-sm font-medium text-[#cdd6f4] transition-colors hover:bg-[#313244] disabled:opacity-50",children:"Cancel"}),(0,a.jsx)("button",{onClick:U,disabled:m||h,className:"flex items-center gap-2 rounded-lg bg-[#F25C05] px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-[#ff6b1a] disabled:opacity-50",children:m?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent"}),"Creating..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.A,{className:"h-4 w-4"}),"Create Deal"]})})]})]})})]}):null}var N=t(22350);function v(e){var s;let{contactId:t,isOpen:n,onClose:c,onContactUpdated:d,onContactDeleted:i}=e,[o,x]=(0,l.useState)(null),[v,C]=(0,l.useState)([]),[k,_]=(0,l.useState)([]),[F,S]=(0,l.useState)(!0),[A,D]=(0,l.useState)(!1),[L,I]=(0,l.useState)(!1),[E,U]=(0,l.useState)(!1),[O,P]=(0,l.useState)(!1),[R,T]=(0,l.useState)(!1),[V,M]=(0,l.useState)(null),{showToast:z}=(0,j.d)(),[B,J]=(0,l.useState)({});(0,l.useEffect)(()=>{n&&t&&(W(),q())},[n,t]);let W=async()=>{try{S(!0);let e=await fetch("/api/contacts/".concat(t));if(!e.ok)throw Error("Failed to fetch contact");let s=await e.json();x(s.contact),J(s.contact),await H()}catch(e){console.error("Error fetching contact:",e),z("Failed to load contact details","error"),c()}finally{S(!1)}},H=async()=>{try{let e=await fetch("/api/deals?contact_id=".concat(t));if(e.ok){let s=await e.json();C(s.deals||[])}}catch(e){console.error("Error fetching deals:",e)}},q=async()=>{try{let e=await fetch("/api/users");if(e.ok){let s=await e.json();_(s.users||[])}}catch(e){console.error("Error fetching users:",e)}},$=e=>{M(e),T(!0)},Z=async()=>{if(o)try{if(I(!0),!(await fetch("/api/contacts/".concat(o.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(B)})).ok)throw Error("Failed to update contact");z("Contact updated successfully!","success"),D(!1),await W(),d()}catch(e){console.error("Error updating contact:",e),z("Failed to update contact","error")}finally{I(!1)}},Q=async()=>{if(o)try{if(!(await fetch("/api/contacts/".concat(o.id),{method:"DELETE"})).ok)throw Error("Failed to delete contact");z("Contact deleted successfully","success"),i(),c()}catch(e){console.error("Error deleting contact:",e),z("Failed to delete contact","error")}},Y=e=>e?new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}):"—";return n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 z-50 bg-black/60 backdrop-blur-sm",onClick:c}),(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:(0,a.jsx)("div",{className:"relative w-full max-w-4xl max-h-[90vh] overflow-hidden rounded-2xl border border-[#313244] bg-[#1e1e2e] shadow-2xl",onClick:e=>e.stopPropagation(),children:F?(0,a.jsx)("div",{className:"flex h-96 items-center justify-center",children:(0,a.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-[#313244] border-t-[#F25C05]"})}):o?(0,a.jsxs)("div",{className:"flex h-full max-h-[90vh] flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between border-b border-[#313244] px-6 py-4",children:[(0,a.jsxs)("button",{onClick:c,className:"flex items-center gap-2 text-sm text-[#a6adc8] transition-colors hover:text-[#cdd6f4]",children:[(0,a.jsx)(m.A,{className:"h-5 w-5"}),"Back"]}),(0,a.jsx)("div",{className:"flex gap-2",children:A?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>{D(!1),J(o||{})},disabled:L,className:"rounded-lg border border-[#313244] bg-transparent px-4 py-2 text-sm font-medium text-[#cdd6f4] transition-colors hover:bg-[#313244] disabled:opacity-50",children:"Cancel"}),(0,a.jsx)("button",{onClick:Z,disabled:L,className:"rounded-lg bg-[#F25C05] px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-[#ff6b1a] disabled:opacity-50",children:L?"Saving...":"Save Changes"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{onClick:()=>P(!0),className:"flex items-center gap-2 rounded-lg bg-[#F25C05] px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-[#ff6b1a]",children:[(0,a.jsx)(r.A,{className:"h-4 w-4"}),"New Deal"]}),(0,a.jsxs)("button",{onClick:()=>{D(!0),J(o||{})},className:"flex items-center gap-2 rounded-lg border border-[#313244] bg-transparent px-4 py-2 text-sm font-medium text-[#cdd6f4] transition-colors hover:bg-[#313244]",children:[(0,a.jsx)(p.A,{className:"h-4 w-4"}),"Edit"]}),(0,a.jsxs)("button",{onClick:()=>U(!0),className:"flex items-center gap-2 rounded-lg border border-red-500/20 bg-transparent px-4 py-2 text-sm font-medium text-red-400 transition-colors hover:bg-red-500/10",children:[(0,a.jsx)(b.A,{className:"h-4 w-4"}),"Delete"]})]})})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[(0,a.jsxs)("div",{className:"mb-6 flex items-start gap-4",children:[(0,a.jsx)(h,{firstName:o.first_name,lastName:o.last_name,size:"lg"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold text-[#cdd6f4]",children:[o.first_name," ",o.last_name]}),o.position&&o.company&&(0,a.jsxs)("p",{className:"mt-1 text-base text-[#a6adc8]",children:[o.position," at ",o.company]}),o.email&&(0,a.jsx)("a",{href:"mailto:".concat(o.email),className:"mt-2 inline-block text-sm text-[#89b4fa] transition-colors hover:text-[#F25C05]",children:o.email})]})]}),(0,a.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"space-y-4 rounded-xl border border-[#313244] bg-[#181825] p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-[#cdd6f4]",children:"Contact Information"}),A?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(w,{label:"Company",value:B.company||"",onChange:e=>J({...B,company:e.target.value})}),(0,a.jsx)(w,{label:"Position",value:B.position||"",onChange:e=>J({...B,position:e.target.value})}),(0,a.jsx)(w,{label:"Email",type:"email",value:B.email||"",onChange:e=>J({...B,email:e.target.value})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-[#a6adc8]",children:"Assign to"}),(0,a.jsxs)("select",{value:B.owner_id||"",onChange:e=>J({...B,owner_id:e.target.value||null}),className:"mt-1 w-full rounded-lg border border-[#313244] bg-[#1e1e2e] px-3 py-2 text-sm text-[#cdd6f4] focus:border-[#F25C05] focus:outline-none focus:ring-1 focus:ring-[#F25C05]",children:[(0,a.jsx)("option",{value:"",children:"Unassigned"}),k.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," (",e.role,")"]},e.id))]})]})]}):(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(y,{label:"LinkedIn",value:(0,a.jsx)("a",{href:o.linkedin_url,target:"_blank",rel:"noopener noreferrer",className:"text-[#89b4fa] transition-colors hover:text-[#F25C05]",children:"View Profile →"})}),(0,a.jsx)(y,{label:"Company",value:o.company||"—"}),(0,a.jsx)(y,{label:"Position",value:o.position||"—"}),(0,a.jsx)(y,{label:"Connected On",value:o.connected_on?Y(o.connected_on):"—"}),(0,a.jsx)(y,{label:"Source",value:o.source}),(0,a.jsx)(y,{label:"Owner",value:o.owner_id?(null==(s=k.find(e=>e.id===o.owner_id))?void 0:s.name)||"Assigned":"Unassigned"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"mb-2 text-sm font-semibold text-[#a6adc8]",children:"Campaigns"}),(0,a.jsx)(f,{campaigns:o.campaigns})]})]}),(0,a.jsxs)("div",{className:"border-t border-[#313244] pt-3 text-xs text-[#6c7086]",children:[(0,a.jsxs)("p",{children:["Created: ",Y(o.created_at)]}),(0,a.jsxs)("p",{children:["Updated: ",Y(o.updated_at)]})]})]}),(0,a.jsxs)("div",{className:"space-y-4 rounded-xl border border-[#313244] bg-[#181825] p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-[#cdd6f4]",children:"Notes"}),A?(0,a.jsxs)("div",{children:[(0,a.jsx)("textarea",{value:B.notes||"",onChange:e=>J({...B,notes:e.target.value}),placeholder:"Add notes here... Markdown supported!",className:"min-h-[300px] w-full rounded-lg border border-[#313244] bg-[#1e1e2e] p-3 text-sm text-[#cdd6f4] placeholder-[#6c7086] focus:border-[#F25C05] focus:outline-none focus:ring-1 focus:ring-[#F25C05]"}),(0,a.jsx)("p",{className:"mt-2 text-xs text-[#6c7086]",children:"Tip: Use Markdown for formatting (e.g., **bold**, *italic*, - bullets)"})]}):(0,a.jsx)("div",{className:"prose prose-invert max-w-none",children:o.notes?(0,a.jsx)("pre",{className:"whitespace-pre-wrap text-sm text-[#cdd6f4]",children:o.notes}):(0,a.jsx)("p",{className:"text-sm text-[#6c7086]",children:"No notes yet. Click Edit to add notes."})})]})]}),(0,a.jsxs)("div",{className:"mt-6 space-y-4 rounded-xl border border-[#313244] bg-[#181825] p-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("h3",{className:"text-lg font-semibold text-[#cdd6f4]",children:["Deals (",v.length,")"]})}),0===v.length?(0,a.jsx)("p",{className:"text-sm text-[#6c7086]",children:'No deals yet. Click "New Deal" to create one.'}):(0,a.jsx)("div",{className:"space-y-3",children:v.map(e=>{var s;return(0,a.jsxs)("div",{onClick:()=>$(e.id),className:"flex items-center justify-between rounded-lg border border-[#313244] bg-[#1e1e2e] p-4 transition-all hover:border-[#F25C05] hover:shadow-lg cursor-pointer",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("h4",{className:"text-base font-semibold text-[#cdd6f4]",children:e.title}),(0,a.jsx)("span",{className:"inline-block rounded-md border px-2 py-0.5 text-xs font-semibold ".concat("Open"===e.status?"bg-green-500/20 text-green-400 border-green-500/50":"Won"===e.status?"bg-blue-500/20 text-blue-400 border-blue-500/50":"bg-red-500/20 text-red-400 border-red-500/50"),children:e.status})]}),(0,a.jsxs)("div",{className:"mt-1 flex items-center gap-4 text-sm text-[#a6adc8]",children:[(0,a.jsx)("span",{children:null===(s=e.value)?"N/A":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(s)}),(0,a.jsx)("span",{children:"•"}),(0,a.jsxs)("span",{children:[e.probability||0,"% probability"]}),(0,a.jsx)("span",{children:"•"}),(0,a.jsx)("span",{children:e.stage.name})]})]}),(0,a.jsx)("button",{onClick:s=>{s.stopPropagation(),$(e.id)},className:"rounded-lg border border-[#313244] bg-transparent p-2 text-[#a6adc8] transition-colors hover:bg-[#313244] hover:text-[#cdd6f4]",children:(0,a.jsx)(u.A,{className:"h-5 w-5"})})]},e.id)})})]})]})]}):null})}),E&&o&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 z-[60] bg-black/80 backdrop-blur-sm",onClick:()=>U(!1)}),(0,a.jsx)("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"w-full max-w-md rounded-2xl border border-red-500/20 bg-[#1e1e2e] p-6 shadow-2xl",onClick:e=>e.stopPropagation(),children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-[#cdd6f4]",children:"Delete Contact?"}),(0,a.jsxs)("p",{className:"mt-3 text-sm text-[#a6adc8]",children:["This will permanently delete ",(0,a.jsxs)("span",{className:"font-semibold text-[#cdd6f4]",children:[o.first_name," ",o.last_name]}),". This action cannot be undone."]}),(0,a.jsxs)("div",{className:"mt-6 flex justify-end gap-3",children:[(0,a.jsx)("button",{onClick:()=>U(!1),className:"rounded-lg border border-[#313244] bg-transparent px-4 py-2 text-sm font-medium text-[#cdd6f4] transition-colors hover:bg-[#313244]",children:"Cancel"}),(0,a.jsx)("button",{onClick:Q,className:"rounded-lg bg-red-500 px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-red-600",children:"Delete Contact"})]})]})})]}),o&&(0,a.jsx)(g,{contactId:o.id,contactName:"".concat(o.first_name," ").concat(o.last_name),contactCompany:o.company,isOpen:O,onClose:()=>P(!1),onDealCreated:W}),V&&(0,a.jsx)(N.A,{dealId:V,isOpen:R,onClose:()=>{T(!1),M(null)},onDealUpdated:H,onDealDeleted:H})]}):null}function y(e){let{label:s,value:t}=e;return(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-[#a6adc8]",children:s}),(0,a.jsx)("p",{className:"mt-1 text-sm text-[#cdd6f4]",children:t})]})}function w(e){let{label:s,value:t,onChange:l,type:n="text"}=e;return(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-[#a6adc8]",children:s}),(0,a.jsx)("input",{type:n,value:t,onChange:l,className:"mt-1 w-full rounded-lg border border-[#313244] bg-[#1e1e2e] px-3 py-2 text-sm text-[#cdd6f4] placeholder-[#6c7086] focus:border-[#F25C05] focus:outline-none focus:ring-1 focus:ring-[#F25C05]"})]})}function C(e){let{isOpen:s,onClose:t,onSuccess:n}=e,r=(0,l.useRef)(null),[c,m]=(0,l.useState)(!1),[p,b]=(0,l.useState)([]),[u,h]=(0,l.useState)(!1),[f,j]=(0,l.useState)(!1),[g,N]=(0,l.useState)(!1),[y,w]=(0,l.useState)([]),[C,k]=(0,l.useState)(!1),[_,F]=(0,l.useState)(null),S=new Date().toISOString().split("T")[0],[A,D]=(0,l.useState)({first_name:"",last_name:"",linkedin_url:"",email:"",position:"",connected_on:S,source:"LinkedIn",campaign_ids:[]}),[L,I]=(0,l.useState)({});(0,l.useEffect)(()=>{s&&E()},[s]),(0,l.useEffect)(()=>{let e=e=>{"Escape"===e.key&&s&&t()};return s&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[s,t]);let E=async()=>{h(!0);try{let e=await fetch("/api/campaigns");if(e.ok){let s=await e.json();b(s.campaigns||[])}}catch(e){console.error("Failed to load campaigns:",e)}finally{h(!1)}},U=e=>/^https?:\/\/(www\.)?linkedin\.com\//.test(e),O=e=>!e||/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),P=async()=>{if(A.linkedin_url||A.first_name&&A.last_name){k(!0);try{let e=new URLSearchParams;A.linkedin_url&&e.append("linkedin_url",A.linkedin_url),A.first_name&&A.last_name&&(e.append("first_name",A.first_name),e.append("last_name",A.last_name));let s=await fetch("/api/contacts/check-duplicate?".concat(e));if(s.ok){let e=await s.json();N(e.isDuplicate),w(e.matches||[])}}catch(e){console.error("Error checking for duplicates:",e)}finally{k(!1)}}},R=async()=>{if(A.linkedin_url){let e=U(A.linkedin_url);j(e),e?(I(e=>{let s={...e};return delete s.linkedin_url,s}),A.linkedin_url&&await P()):(I(e=>({...e,linkedin_url:"Must be a valid LinkedIn profile URL (e.g., https://www.linkedin.com/in/username)"})),N(!1),w([]))}},T=(e,s)=>{D(t=>({...t,[e]:s})),L[e]&&I(s=>{let t={...s};return delete t[e],t}),"linkedin_url"===e&&(j(!1),N(!1),w([]))},V=async e=>{if(e.preventDefault(),(()=>{let e={};return A.first_name.trim()||(e.first_name="First name is required"),A.last_name.trim()||(e.last_name="Last name is required"),A.linkedin_url.trim()&&!U(A.linkedin_url)&&(e.linkedin_url="Must be a valid LinkedIn URL (e.g., https://linkedin.com/in/username)"),A.email&&!O(A.email)&&(e.email="Please enter a valid email address"),0===A.campaign_ids.length&&(e.campaign_ids="Please select at least one campaign"),I(e),0===Object.keys(e).length})()){m(!0);try{let e=await fetch("/api/contacts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(A)}),a=await e.json();if(e.ok)D({first_name:"",last_name:"",linkedin_url:"",email:"",position:"",connected_on:S,source:"LinkedIn",campaign_ids:[]}),j(!1),I({}),n();else{var s,t;(null==(s=a.error)?void 0:s.includes("duplicate"))||(null==(t=a.error)?void 0:t.includes("already exists"))?I(e=>({...e,linkedin_url:"A contact with this LinkedIn URL already exists"})):I(e=>({...e,linkedin_url:a.error||"Failed to create contact"}))}}catch(e){console.error("Submit error:",e),I(e=>({...e,linkedin_url:"An unexpected error occurred. Please try again."}))}finally{m(!1)}}};return s?(0,a.jsxs)("div",{onClick:e=>{e.target===e.currentTarget&&t()},className:"jsx-2c8bf314faae8ebd fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:[(0,a.jsxs)("div",{ref:r,style:{animation:"slideUp 0.3s ease"},className:"jsx-2c8bf314faae8ebd relative w-full max-w-[600px] animate-slideUp rounded-lg bg-[#181825] shadow-xl",children:[(0,a.jsxs)("div",{className:"jsx-2c8bf314faae8ebd flex items-center justify-between border-b border-[#313244] px-6 py-4",children:[(0,a.jsx)("h2",{className:"jsx-2c8bf314faae8ebd text-xl font-semibold text-[#cdd6f4]",children:"New Contact"}),(0,a.jsx)("button",{onClick:t,className:"jsx-2c8bf314faae8ebd rounded-lg p-1 text-[#a6adc8] transition-colors hover:bg-[#313244] hover:text-[#cdd6f4]",children:(0,a.jsx)(i.A,{className:"h-5 w-5"})})]}),(0,a.jsxs)("form",{onSubmit:V,className:"jsx-2c8bf314faae8ebd max-h-[calc(100vh-200px)] overflow-y-auto px-6 py-4",children:[(0,a.jsxs)("div",{className:"jsx-2c8bf314faae8ebd space-y-4",children:[(0,a.jsxs)("div",{className:"jsx-2c8bf314faae8ebd",children:[(0,a.jsxs)("label",{htmlFor:"first_name",className:"jsx-2c8bf314faae8ebd mb-1 block text-sm font-medium text-[#cdd6f4]",children:["First Name ",(0,a.jsx)("span",{className:"jsx-2c8bf314faae8ebd text-red-400",children:"*"})]}),(0,a.jsx)("input",{type:"text",id:"first_name",value:A.first_name,onChange:e=>T("first_name",e.target.value),placeholder:"John",className:"jsx-2c8bf314faae8ebd "+"w-full rounded-lg border ".concat(L.first_name?"border-red-400":"border-[#313244]"," bg-[#1e1e2e] px-3 py-2 text-[#cdd6f4] placeholder-[#6c7086] focus:border-[#F25C05] focus:outline-none focus:ring-1 focus:ring-[#F25C05]")}),L.first_name&&(0,a.jsx)("p",{className:"jsx-2c8bf314faae8ebd mt-1 text-sm text-red-400",children:L.first_name})]}),(0,a.jsxs)("div",{className:"jsx-2c8bf314faae8ebd",children:[(0,a.jsxs)("label",{htmlFor:"last_name",className:"jsx-2c8bf314faae8ebd mb-1 block text-sm font-medium text-[#cdd6f4]",children:["Last Name ",(0,a.jsx)("span",{className:"jsx-2c8bf314faae8ebd text-red-400",children:"*"})]}),(0,a.jsx)("input",{type:"text",id:"last_name",value:A.last_name,onChange:e=>T("last_name",e.target.value),placeholder:"Doe",className:"jsx-2c8bf314faae8ebd "+"w-full rounded-lg border ".concat(L.last_name?"border-red-400":"border-[#313244]"," bg-[#1e1e2e] px-3 py-2 text-[#cdd6f4] placeholder-[#6c7086] focus:border-[#F25C05] focus:outline-none focus:ring-1 focus:ring-[#F25C05]")}),L.last_name&&(0,a.jsx)("p",{className:"jsx-2c8bf314faae8ebd mt-1 text-sm text-red-400",children:L.last_name})]}),(0,a.jsxs)("div",{className:"jsx-2c8bf314faae8ebd",children:[(0,a.jsx)("label",{htmlFor:"linkedin_url",className:"jsx-2c8bf314faae8ebd mb-1 block text-sm font-medium text-[#cdd6f4]",children:"LinkedIn URL"}),(0,a.jsxs)("div",{className:"jsx-2c8bf314faae8ebd relative",children:[(0,a.jsx)("input",{type:"url",id:"linkedin_url",value:A.linkedin_url,onChange:e=>T("linkedin_url",e.target.value),onBlur:R,placeholder:"https://www.linkedin.com/in/username",className:"jsx-2c8bf314faae8ebd "+"w-full rounded-lg border ".concat(L.linkedin_url?"border-red-400":f?"border-green-500":"border-[#313244]"," bg-[#1e1e2e] px-3 py-2 pr-10 text-[#cdd6f4] placeholder-[#6c7086] focus:border-[#F25C05] focus:outline-none focus:ring-1 focus:ring-[#F25C05]")}),f&&(0,a.jsx)(o.A,{className:"absolute right-3 top-2.5 h-5 w-5 text-green-500"})]}),L.linkedin_url&&(0,a.jsx)("p",{className:"jsx-2c8bf314faae8ebd mt-1 text-sm text-red-400",children:L.linkedin_url}),!L.linkedin_url&&!f&&!g&&A.linkedin_url&&(0,a.jsx)("p",{className:"jsx-2c8bf314faae8ebd mt-1 text-xs text-[#6c7086]",children:"Optional - Accepts any valid LinkedIn URL (personal or company profiles)"}),C&&(0,a.jsx)("p",{className:"jsx-2c8bf314faae8ebd mt-1 text-xs text-[#a6adc8]",children:"Checking for duplicates..."}),!L.linkedin_url&&g&&y.length>0&&(0,a.jsx)("div",{className:"jsx-2c8bf314faae8ebd mt-2 rounded-lg border-l-4 border-[#f9e2af] bg-[#f9e2af]/10 p-3",children:(0,a.jsxs)("div",{className:"jsx-2c8bf314faae8ebd flex items-start gap-2",children:[(0,a.jsx)(x.A,{className:"h-5 w-5 flex-shrink-0 text-[#f9e2af]"}),(0,a.jsxs)("div",{className:"jsx-2c8bf314faae8ebd flex-1",children:[(0,a.jsx)("p",{className:"jsx-2c8bf314faae8ebd text-sm font-medium text-[#f9e2af]",children:"This contact may already exist"}),y.map(e=>(0,a.jsxs)("div",{className:"jsx-2c8bf314faae8ebd mt-1 text-sm text-[#cdd6f4]",children:[(0,a.jsxs)("span",{className:"jsx-2c8bf314faae8ebd font-semibold",children:[e.first_name," ",e.last_name]})," • ",(0,a.jsx)("button",{type:"button",onClick:()=>F(e.id),className:"jsx-2c8bf314faae8ebd text-[#89b4fa] hover:text-[#F25C05] hover:underline",children:"View Contact"})]},e.id))]})]})})]}),(0,a.jsxs)("div",{className:"jsx-2c8bf314faae8ebd",children:[(0,a.jsx)("label",{htmlFor:"email",className:"jsx-2c8bf314faae8ebd mb-1 block text-sm font-medium text-[#cdd6f4]",children:"Email"}),(0,a.jsx)("input",{type:"email",id:"email",value:A.email,onChange:e=>T("email",e.target.value),onBlur:()=>{A.email&&!O(A.email)?I(e=>({...e,email:"Please enter a valid email address"})):I(e=>{let s={...e};return delete s.email,s})},placeholder:"john.doe@example.com",className:"jsx-2c8bf314faae8ebd "+"w-full rounded-lg border ".concat(L.email?"border-red-400":"border-[#313244]"," bg-[#1e1e2e] px-3 py-2 text-[#cdd6f4] placeholder-[#6c7086] focus:border-[#F25C05] focus:outline-none focus:ring-1 focus:ring-[#F25C05]")}),L.email&&(0,a.jsx)("p",{className:"jsx-2c8bf314faae8ebd mt-1 text-sm text-red-400",children:L.email})]}),(0,a.jsxs)("div",{className:"jsx-2c8bf314faae8ebd",children:[(0,a.jsx)("label",{htmlFor:"position",className:"jsx-2c8bf314faae8ebd mb-1 block text-sm font-medium text-[#cdd6f4]",children:"Position"}),(0,a.jsx)("input",{type:"text",id:"position",value:A.position,onChange:e=>T("position",e.target.value),placeholder:"Senior Developer",className:"jsx-2c8bf314faae8ebd w-full rounded-lg border border-[#313244] bg-[#1e1e2e] px-3 py-2 text-[#cdd6f4] placeholder-[#6c7086] focus:border-[#F25C05] focus:outline-none focus:ring-1 focus:ring-[#F25C05]"})]}),(0,a.jsxs)("div",{className:"jsx-2c8bf314faae8ebd",children:[(0,a.jsx)("label",{htmlFor:"connected_on",className:"jsx-2c8bf314faae8ebd mb-1 block text-sm font-medium text-[#cdd6f4]",children:"Connected On"}),(0,a.jsx)("input",{type:"date",id:"connected_on",value:A.connected_on,onChange:e=>T("connected_on",e.target.value),max:S,className:"jsx-2c8bf314faae8ebd w-full rounded-lg border border-[#313244] bg-[#1e1e2e] px-3 py-2 text-[#cdd6f4] focus:border-[#F25C05] focus:outline-none focus:ring-1 focus:ring-[#F25C05]"})]}),(0,a.jsxs)("div",{className:"jsx-2c8bf314faae8ebd",children:[(0,a.jsx)("label",{htmlFor:"source",className:"jsx-2c8bf314faae8ebd mb-1 block text-sm font-medium text-[#cdd6f4]",children:"Lead Source"}),(0,a.jsxs)("select",{id:"source",value:A.source,onChange:e=>T("source",e.target.value),className:"jsx-2c8bf314faae8ebd w-full rounded-lg border border-[#313244] bg-[#1e1e2e] px-3 py-2 text-[#cdd6f4] focus:border-[#F25C05] focus:outline-none focus:ring-1 focus:ring-[#F25C05]",children:[(0,a.jsx)("option",{value:"LinkedIn",className:"jsx-2c8bf314faae8ebd",children:"LinkedIn"}),(0,a.jsx)("option",{value:"Referral",className:"jsx-2c8bf314faae8ebd",children:"Referral"}),(0,a.jsx)("option",{value:"Website",className:"jsx-2c8bf314faae8ebd",children:"Website"}),(0,a.jsx)("option",{value:"Event",className:"jsx-2c8bf314faae8ebd",children:"Event"}),(0,a.jsx)("option",{value:"Other",className:"jsx-2c8bf314faae8ebd",children:"Other"})]})]}),(0,a.jsxs)("div",{className:"jsx-2c8bf314faae8ebd",children:[(0,a.jsxs)("label",{className:"jsx-2c8bf314faae8ebd mb-1 block text-sm font-medium text-[#cdd6f4]",children:["Campaigns ",(0,a.jsx)("span",{className:"jsx-2c8bf314faae8ebd text-red-400",children:"*"})]}),u?(0,a.jsx)("div",{className:"jsx-2c8bf314faae8ebd rounded-lg border border-[#313244] bg-[#1e1e2e] px-3 py-2 text-[#6c7086]",children:"Loading campaigns..."}):0===p.length?(0,a.jsx)("div",{className:"jsx-2c8bf314faae8ebd rounded-lg border border-[#313244] bg-[#1e1e2e] px-3 py-2 text-[#6c7086]",children:"No campaigns available"}):(0,a.jsxs)("div",{className:"jsx-2c8bf314faae8ebd "+"rounded-lg border ".concat(L.campaign_ids?"border-red-400":"border-[#313244]"," bg-[#1e1e2e] p-3"),children:[(0,a.jsx)("div",{className:"jsx-2c8bf314faae8ebd max-h-[150px] space-y-2 overflow-y-auto",children:p.map(e=>(0,a.jsxs)("label",{className:"jsx-2c8bf314faae8ebd flex cursor-pointer items-center space-x-2 rounded px-2 py-1 hover:bg-[#313244]",children:[(0,a.jsx)("input",{type:"checkbox",checked:A.campaign_ids.includes(e.id),onChange:()=>{var s;return s=e.id,void(D(e=>{let t=e.campaign_ids.includes(s);return{...e,campaign_ids:t?e.campaign_ids.filter(e=>e!==s):[...e.campaign_ids,s]}}),L.campaign_ids&&I(e=>{let s={...e};return delete s.campaign_ids,s}))},className:"jsx-2c8bf314faae8ebd h-4 w-4 rounded border-[#6c7086] bg-[#1e1e2e] text-[#F25C05] focus:ring-2 focus:ring-[#F25C05] focus:ring-offset-0"}),(0,a.jsx)("span",{className:"jsx-2c8bf314faae8ebd text-sm text-[#cdd6f4]",children:e.name})]},e.id))}),A.campaign_ids.length>0&&(0,a.jsx)("div",{className:"jsx-2c8bf314faae8ebd mt-2 border-t border-[#313244] pt-2",children:(0,a.jsxs)("span",{className:"jsx-2c8bf314faae8ebd text-xs text-[#6c7086]",children:[A.campaign_ids.length," campaign",1!==A.campaign_ids.length?"s":""," selected"]})})]}),L.campaign_ids&&(0,a.jsx)("p",{className:"jsx-2c8bf314faae8ebd mt-1 text-sm text-red-400",children:L.campaign_ids})]})]}),(0,a.jsxs)("div",{className:"jsx-2c8bf314faae8ebd mt-6 flex justify-end gap-3 border-t border-[#313244] pt-4",children:[(0,a.jsx)("button",{type:"button",onClick:t,disabled:c,className:"jsx-2c8bf314faae8ebd rounded-lg border border-[#313244] bg-transparent px-4 py-2 text-sm font-medium text-[#cdd6f4] transition-colors hover:bg-[#313244] disabled:opacity-50",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:c,className:"jsx-2c8bf314faae8ebd "+"flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed ".concat(g?"bg-[#f9e2af] text-[#1e1e2e] hover:bg-[#f9e2af]/90":"bg-[#F25C05] text-white hover:bg-[#ff6b1a]"),children:c?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{viewBox:"0 0 24 24",className:"jsx-2c8bf314faae8ebd h-4 w-4 animate-spin",children:[(0,a.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none",className:"jsx-2c8bf314faae8ebd opacity-25"}),(0,a.jsx)("path",{fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",className:"jsx-2c8bf314faae8ebd opacity-75"})]}),"Creating..."]}):g?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.A,{className:"h-4 w-4"}),"Add Anyway"]}):"Create Contact"})]})]})]}),(0,a.jsx)(d(),{id:"2c8bf314faae8ebd",children:"@keyframes slideUp{from{opacity:0;transform:translatey(20px)}to{opacity:1;transform:translatey(0)}}"}),_&&(0,a.jsx)(v,{contactId:_,isOpen:!0,onClose:()=>F(null),onContactUpdated:()=>{},onContactDeleted:()=>{}})]}):null}var k=t(45748),_=t(39059),F=t(9349),S=t.n(F);async function A(e){return new Promise((s,t)=>{let a=[],l=[],n=0;S().parse(e,{header:!0,skipEmptyLines:!0,transformHeader:e=>e.trim(),complete:e=>{n=e.data.length,e.data.forEach((e,s)=>{var t,n,r;let c,d=s+2;if(!e["First Name"]||!e["Last Name"]||!e.URL)return void l.push({row:d,message:"Missing required fields (First Name, Last Name, or URL)"});if(!/^https?:\/\/(www\.)?linkedin\.com\//.test(e.URL))return void l.push({row:d,message:"Invalid LinkedIn URL format - must be a valid LinkedIn URL"});if(e["Connected On"]){let s=new Date(e["Connected On"]);isNaN(s.getTime())?l.push({row:d,message:"Invalid date format in Connected On: ".concat(e["Connected On"])}):c=s.toISOString().split("T")[0]}let i={first_name:e["First Name"].trim(),last_name:e["Last Name"].trim(),linkedin_url:e.URL.trim(),email:(null==(t=e["Email Address"])?void 0:t.trim())||void 0,company:(null==(n=e.Company)?void 0:n.trim())||void 0,position:(null==(r=e.Position)?void 0:r.trim())||void 0,connected_on:c,source:"CSV Import"};a.push(i)}),s({contacts:a,errors:l,totalRows:n,validRows:a.length})},error:e=>{t(Error("CSV parsing failed: ".concat(e.message)))}})})}function D(e){let{isOpen:s,onClose:t,onSuccess:r}=e,[c,d]=(0,l.useState)(1),[o,x]=(0,l.useState)(null),[p,b]=(0,l.useState)(null),[u,h]=(0,l.useState)([]),[f,j]=(0,l.useState)([]),[g,N]=(0,l.useState)([]),[v,y]=(0,l.useState)(!1),[w,C]=(0,l.useState)(!1),[F,S]=(0,l.useState)(null),[D,L]=(0,l.useState)(!1),[I,E]=(0,l.useState)(!1),[U,O]=(0,l.useState)(!1),[P,R]=(0,l.useState)({imported:0,updated:0,skipped:0}),[T,V]=(0,l.useState)(!1),[M,z]=(0,l.useState)([]),[B,J]=(0,l.useState)(0),[W,H]=(0,l.useState)(new Map),q=(0,l.useRef)(null),$=async e=>{if((S(null),e.name.toLowerCase().endsWith(".csv"))&&!(e.size>5242880)||(S("Invalid file. Please upload a .csv file under 5MB."),0)){x(e),C(!0),S(null),h([]);try{let s=await A(e);s.errors.length>0?(h(s.errors),b(null)):(b(s),h([]))}catch(e){S("Failed to parse CSV file. Please ensure it is a valid LinkedIn export."),console.error("CSV parsing error:",e)}finally{C(!1)}}},Z=(0,l.useCallback)(async()=>{if(!T)try{let e=await fetch("/api/campaigns");if(e.ok){let s=await e.json();N(s.campaigns||[]),V(!0)}}catch(e){console.error("Failed to fetch campaigns:",e)}},[T]),Q=async()=>{if(1===c&&p)await Z(),d(2);else if(2===c){C(!0);try{let e=await fetch("/api/contacts/check-duplicates",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contacts:(null==p?void 0:p.contacts)||[]})});if(e.ok){let s=await e.json();if(s.duplicates&&s.duplicates.length>0){z(s.duplicates),J(0);let e=new Map;s.duplicates.forEach(s=>{e.set(s.csvIndex,"import")}),H(e),d(3)}else d(4)}}catch(e){console.error("Duplicate check error:",e),d(4)}finally{C(!1)}}else 3===c&&d(4)},Y=async()=>{E(!0);try{let e=await fetch("/api/contacts/bulk-import",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contacts:(null==p?void 0:p.contacts)||[],campaign_ids:f,overwrite_ids:[]})});if(e.ok){let s=await e.json();R({imported:s.imported||0,updated:s.updated||0,skipped:s.skipped||0}),O(!0)}else throw Error("Import failed")}catch(e){console.error("Import error:",e),S("Failed to import contacts. Please try again.")}finally{E(!1)}},G=()=>{c>1||o?L(!0):X()},K=(e,s)=>{H(t=>{let a=new Map(t);return a.set(e,s),a})},X=()=>{d(1),x(null),b(null),h([]),j([]),S(null),C(!1),E(!1),O(!1),L(!1),V(!1),z([]),J(0),H(new Map),t()};if(!s)return null;if(U){let e=g.filter(e=>f.includes(e.id)).map(e=>e.name);return(0,a.jsx)("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-8",children:(0,a.jsxs)("div",{className:"bg-[#181825] border border-[#313244] rounded-2xl max-w-[500px] w-full p-8 shadow-2xl",children:[(0,a.jsx)("div",{className:"flex justify-center mb-6",children:(0,a.jsx)("div",{className:"w-16 h-16 rounded-full bg-green-500/20 flex items-center justify-center",children:(0,a.jsx)(k.A,{className:"w-8 h-8 text-green-500"})})}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-[#cdd6f4] text-center mb-4",children:"Import Complete!"}),(0,a.jsxs)("div",{className:"space-y-3 mb-6 p-4 bg-[#1e1e2e] rounded-lg",children:[(0,a.jsxs)("div",{className:"flex justify-between text-[#cdd6f4]",children:[(0,a.jsx)("span",{children:"Successfully imported:"}),(0,a.jsxs)("span",{className:"font-semibold",children:[P.imported," contacts"]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-[#a6adc8]",children:[(0,a.jsx)("span",{children:"Updated:"}),(0,a.jsxs)("span",{children:[P.updated," contacts"]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-[#a6adc8]",children:[(0,a.jsx)("span",{children:"Skipped:"}),(0,a.jsxs)("span",{children:[P.skipped," duplicates"]})]})]}),e.length>0&&(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("p",{className:"text-sm text-[#a6adc8] mb-2",children:"All contacts assigned to:"}),(0,a.jsx)("ul",{className:"space-y-1",children:e.map((e,s)=>(0,a.jsxs)("li",{className:"text-sm text-[#cdd6f4] flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-1.5 h-1.5 rounded-full bg-[#F25C05]"}),e]},s))})]}),(0,a.jsx)("button",{onClick:()=>{X(),r()},className:"w-full bg-[#F25C05] hover:bg-[#D94C04] text-white font-semibold px-4 py-3 rounded-lg shadow-[0_2px_8px_rgba(242,92,5,0.3)] hover:shadow-[0_4px_12px_rgba(242,92,5,0.4)] hover:-translate-y-0.5 transition-all duration-200",children:"View Contacts"})]})})}return D?(0,a.jsx)("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-8",children:(0,a.jsxs)("div",{className:"bg-[#181825] border border-[#313244] rounded-2xl max-w-[400px] w-full p-6 shadow-2xl",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-[#cdd6f4] mb-3",children:"Cancel Upload?"}),(0,a.jsx)("p",{className:"text-sm text-[#a6adc8] mb-6",children:"Are you sure? All progress will be lost."}),(0,a.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,a.jsx)("button",{onClick:()=>L(!1),className:"bg-[#313244] hover:bg-[#45475a] text-[#cdd6f4] font-semibold px-4 py-2 rounded-lg transition-all duration-200",children:"Continue Upload"}),(0,a.jsx)("button",{onClick:()=>{L(!1),X()},className:"bg-red-500/20 hover:bg-red-500/30 text-red-400 font-semibold px-4 py-2 rounded-lg transition-all duration-200",children:"Yes, Cancel"})]})]})}):(0,a.jsx)("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-8",children:(0,a.jsxs)("div",{className:"bg-[#181825] border border-[#313244] rounded-2xl max-w-[800px] w-full max-h-[90vh] overflow-y-auto shadow-2xl",children:[(0,a.jsx)(()=>(0,a.jsx)("div",{className:"flex items-center justify-center gap-2 mb-8 px-6 pt-6",children:[1,2,3,4].map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"\n            w-10 h-10 rounded-full flex items-center justify-center font-semibold text-sm transition-all duration-200\n            ".concat(e<c?"bg-[#F25C05] text-white":"","\n            ").concat(e===c?"bg-[#F25C05] text-white ring-2 ring-[#F25C05] ring-offset-2 ring-offset-[#181825]":"","\n            ").concat(e>c?"bg-transparent border-2 border-[#6c7086] text-[#6c7086]":"","\n          "),children:e<c?(0,a.jsx)(k.A,{className:"w-5 h-5"}):e}),s<3&&(0,a.jsx)("div",{className:"h-0.5 w-8 transition-colors duration-200 ".concat(e<c?"bg-[#F25C05]":"bg-[#45475a]")})]},e))}),{}),(0,a.jsx)("div",{className:"px-6 pb-4 border-b border-[#313244]",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-[#cdd6f4]",children:["Step ",c," of 4: ",1===c?"Upload CSV File":2===c?"Preview Contacts":3===c?"Resolve Duplicates":"Confirm Import"]}),(0,a.jsx)("button",{onClick:G,className:"text-[#a6adc8] hover:text-[#cdd6f4] transition-colors",children:(0,a.jsx)(i.A,{className:"w-6 h-6"})})]})}),(0,a.jsxs)("div",{className:"p-6",children:[1===c&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{onDragOver:e=>{e.preventDefault(),y(!0)},onDragLeave:()=>{y(!1)},onDrop:e=>{e.preventDefault(),y(!1);let s=e.dataTransfer.files[0];s&&$(s)},onClick:()=>{var e;null==(e=q.current)||e.click()},className:"\n                  h-[200px] border-2 border-dashed rounded-xl flex flex-col items-center justify-center cursor-pointer transition-all duration-200\n                  ".concat(v?"border-[#F25C05] bg-[rgba(242,92,5,0.1)] border-solid":F?"border-red-500 bg-red-500/10":"border-[#45475a] bg-[#313244] hover:border-[#F25C05] hover:bg-[rgba(242,92,5,0.05)]","\n                "),children:[(0,a.jsx)("input",{ref:q,type:"file",accept:".csv",onChange:e=>{var s;let t=null==(s=e.target.files)?void 0:s[0];t&&$(t)},className:"hidden"}),(0,a.jsx)(n.A,{className:"w-12 h-12 text-[#a6adc8] mb-3"}),(0,a.jsx)("p",{className:"text-[#cdd6f4] font-medium mb-1",children:"\uD83D\uDCC1 Drag and drop CSV file here or click to browse"}),(0,a.jsx)("p",{className:"text-sm text-[#6c7086]",children:"Supported: .csv files only"})]}),(0,a.jsx)("div",{className:"mt-4 p-3 bg-[#1e1e2e] rounded-lg border border-[#313244]",children:(0,a.jsxs)("p",{className:"text-sm text-[#a6adc8]",children:["\uD83D\uDCA1 ",(0,a.jsx)("span",{className:"font-semibold",children:"Tip:"})," Export from LinkedIn: Connections → Manage synced contacts → Download"]})}),w&&(0,a.jsxs)("div",{className:"mt-6 flex items-center justify-center gap-3",children:[(0,a.jsx)("div",{className:"h-5 w-5 animate-spin rounded-full border-2 border-[#313244] border-t-[#F25C05]"}),(0,a.jsx)("p",{className:"text-sm text-[#a6adc8]",children:"Parsing CSV..."})]}),F&&(0,a.jsx)("div",{className:"mt-4 p-4 bg-red-500/10 border border-red-500/20 rounded-lg",children:(0,a.jsx)("p",{className:"text-sm text-red-400",children:F})}),u.length>0&&(0,a.jsxs)("div",{className:"mt-4 p-4 bg-red-500/10 border border-red-500/20 rounded-lg",children:[(0,a.jsxs)("p",{className:"text-sm font-semibold text-red-400 mb-2",children:["Found ",u.length," errors in CSV file"]}),(0,a.jsx)("ul",{className:"space-y-1 mb-3",children:u.slice(0,10).map((e,s)=>(0,a.jsxs)("li",{className:"text-xs text-red-300",children:["Row ",e.row,": ",e.message]},s))}),u.length>10&&(0,a.jsxs)("p",{className:"text-xs text-red-300 mb-3",children:["and ",u.length-10," more..."]}),(0,a.jsx)("button",{onClick:()=>{let e=new Blob([u.map(e=>"Row ".concat(e.row,": ").concat(e.message)).join("\n")],{type:"text/plain"}),s=URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.download="csv-errors.txt",document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(s)},className:"text-xs text-red-400 hover:text-red-300 underline",children:"Download Error Report"})]}),p&&(0,a.jsx)("div",{className:"mt-4 p-4 bg-green-500/10 border border-green-500/20 rounded-lg",children:(0,a.jsxs)("p",{className:"text-sm text-green-400",children:["✓ Successfully parsed: ",p.validRows," contacts"]})})]}),2===c&&p&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"mb-6 p-4 bg-[#1e1e2e] rounded-lg border border-[#313244]",children:(0,a.jsxs)("p",{className:"text-[#cdd6f4] font-medium",children:["Successfully parsed: ",(0,a.jsx)("span",{className:"text-[#F25C05]",children:p.validRows})," contacts"]})}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-[#cdd6f4] mb-2",children:["Assign to Campaign(s): ",(0,a.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,a.jsxs)("div",{className:"space-y-2 max-h-[150px] overflow-y-auto p-3 bg-[#1e1e2e] rounded-lg border border-[#313244]",children:[g.map(e=>(0,a.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer hover:bg-[#313244] p-2 rounded transition-colors",children:[(0,a.jsx)("input",{type:"checkbox",checked:f.includes(e.id),onChange:()=>{var s;return s=e.id,void j(e=>e.includes(s)?e.filter(e=>e!==s):[...e,s])},className:"w-4 h-4 text-[#F25C05] bg-[#313244] border-[#45475a] rounded focus:ring-[#F25C05] focus:ring-2"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm text-[#cdd6f4] font-medium",children:e.name}),e.description&&(0,a.jsx)("p",{className:"text-xs text-[#6c7086]",children:e.description})]})]},e.id)),0===g.length&&(0,a.jsx)("p",{className:"text-sm text-[#6c7086] text-center py-2",children:"No campaigns available"})]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-[#cdd6f4] mb-3",children:"Contact Preview"}),(0,a.jsx)("div",{className:"overflow-x-auto rounded-lg border border-[#313244]",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"border-b border-[#313244] bg-[#1e1e2e]",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-left px-3 py-3 text-xs font-semibold uppercase tracking-wider text-[#7f849c]",children:"Name"}),(0,a.jsx)("th",{className:"text-left px-3 py-3 text-xs font-semibold uppercase tracking-wider text-[#7f849c]",children:"Company"}),(0,a.jsx)("th",{className:"text-left px-3 py-3 text-xs font-semibold uppercase tracking-wider text-[#7f849c]",children:"Position"}),(0,a.jsx)("th",{className:"text-left px-3 py-3 text-xs font-semibold uppercase tracking-wider text-[#7f849c]",children:"LinkedIn"})]})}),(0,a.jsx)("tbody",{children:p.contacts.slice(0,5).map((e,s)=>(0,a.jsxs)("tr",{className:"border-b border-[#313244] hover:bg-[rgba(242,92,5,0.03)] transition-colors",children:[(0,a.jsxs)("td",{className:"px-3 py-3 text-sm text-[#cdd6f4]",children:[e.first_name," ",e.last_name]}),(0,a.jsx)("td",{className:"px-3 py-3 text-sm text-[#a6adc8]",children:e.company||"-"}),(0,a.jsx)("td",{className:"px-3 py-3 text-sm text-[#a6adc8]",children:e.position||"-"}),(0,a.jsx)("td",{className:"px-3 py-3 text-sm",children:e.linkedin_url?(0,a.jsx)("a",{href:e.linkedin_url,target:"_blank",rel:"noopener noreferrer",className:"text-[#F25C05] hover:underline",children:"View"}):"-"})]},s))})]})}),p.contacts.length>5&&(0,a.jsxs)("p",{className:"text-xs text-[#6c7086] mt-2 text-center",children:["... and ",p.contacts.length-5," more"]})]})]}),3===c&&M.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-6 p-4 bg-yellow-500/10 border border-yellow-500/20 rounded-lg",children:[(0,a.jsxs)("p",{className:"text-sm text-yellow-400 flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-lg",children:"⚠️"}),"Found ",M.length," potential duplicate",1!==M.length?"s":""]}),(0,a.jsx)("p",{className:"text-xs text-[#a6adc8] mt-1",children:"For each duplicate, choose an action"})]}),M[B]&&(0,a.jsxs)("div",{className:"mb-6 p-6 bg-[#313244] border border-[#45475a] rounded-xl",children:[(0,a.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-[#cdd6f4]",children:[M[B].csvContact.first_name," ",M[B].csvContact.last_name]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat("high"===M[B].confidence?"bg-red-500/20 text-red-400 border border-red-500/30":"bg-yellow-500/20 text-yellow-400 border border-yellow-500/30"),children:"high"===M[B].confidence?"High confidence":"Possible duplicate"}),(0,a.jsx)("span",{className:"text-xs text-[#6c7086]",children:"linkedin_url"===M[B].matchType?"LinkedIn URL match":"Name match"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-[#F25C05] uppercase tracking-wide mb-3",children:"From CSV"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-[#6c7086]",children:"Company:"}),(0,a.jsx)("span",{className:"ml-2 text-[#cdd6f4]",children:M[B].csvContact.company||"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-[#6c7086]",children:"Position:"}),(0,a.jsx)("span",{className:"ml-2 text-[#cdd6f4]",children:M[B].csvContact.position||"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-[#6c7086]",children:"Email:"}),(0,a.jsx)("span",{className:"ml-2 text-[#cdd6f4]",children:M[B].csvContact.email||"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-[#6c7086]",children:"LinkedIn:"}),(0,a.jsx)("span",{className:"ml-2 text-[#89b4fa] text-xs break-all",children:M[B].csvContact.linkedin_url})]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-[#89b4fa] uppercase tracking-wide mb-3",children:"Already in Database"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-[#6c7086]",children:"Company:"}),(0,a.jsx)("span",{className:"ml-2 text-[#cdd6f4]",children:M[B].existingContact.company||"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-[#6c7086]",children:"Position:"}),(0,a.jsx)("span",{className:"ml-2 text-[#cdd6f4]",children:M[B].existingContact.position||"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-[#6c7086]",children:"Email:"}),(0,a.jsx)("span",{className:"ml-2 text-[#cdd6f4]",children:M[B].existingContact.email||"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-[#6c7086]",children:"LinkedIn:"}),(0,a.jsx)("span",{className:"ml-2 text-[#89b4fa] text-xs break-all",children:M[B].existingContact.linkedin_url})]}),(0,a.jsx)("div",{className:"pt-2",children:(0,a.jsxs)("span",{className:"text-xs text-[#6c7086]",children:["Created: ",new Date(M[B].existingContact.created_at).toLocaleDateString()]})})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-[#cdd6f4] mb-3",children:"Choose Action:"}),(0,a.jsxs)("label",{className:"flex items-center gap-3 p-3 bg-[#1e1e2e] border border-[#45475a] rounded-lg cursor-pointer hover:border-[#F25C05] transition-colors",children:[(0,a.jsx)("input",{type:"radio",name:"duplicate-".concat(B),checked:"update"===W.get(M[B].csvIndex),onChange:()=>K(M[B].csvIndex,"update"),className:"w-4 h-4 text-[#F25C05] bg-[#313244] border-[#45475a] focus:ring-[#F25C05] focus:ring-2"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-[#cdd6f4]",children:"Update existing with CSV data"}),(0,a.jsx)("p",{className:"text-xs text-[#6c7086]",children:"Overwrites the existing contact"})]})]}),(0,a.jsxs)("label",{className:"flex items-center gap-3 p-3 bg-[#1e1e2e] border border-[#45475a] rounded-lg cursor-pointer hover:border-[#F25C05] transition-colors",children:[(0,a.jsx)("input",{type:"radio",name:"duplicate-".concat(B),checked:"skip"===W.get(M[B].csvIndex),onChange:()=>K(M[B].csvIndex,"skip"),className:"w-4 h-4 text-[#F25C05] bg-[#313244] border-[#45475a] focus:ring-[#F25C05] focus:ring-2"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-[#cdd6f4]",children:"Skip (keep existing)"}),(0,a.jsx)("p",{className:"text-xs text-[#6c7086]",children:"Don't import this CSV row"})]})]}),(0,a.jsxs)("label",{className:"flex items-center gap-3 p-3 bg-[#1e1e2e] border border-[#45475a] rounded-lg cursor-pointer hover:border-[#F25C05] transition-colors",children:[(0,a.jsx)("input",{type:"radio",name:"duplicate-".concat(B),checked:"import"===W.get(M[B].csvIndex),onChange:()=>K(M[B].csvIndex,"import"),className:"w-4 h-4 text-[#F25C05] bg-[#313244] border-[#45475a] focus:ring-[#F25C05] focus:ring-2"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-[#cdd6f4]",children:"Import as new contact"}),(0,a.jsx)("p",{className:"text-xs text-[#6c7086]",children:"Create a new contact despite duplicate warning"})]})]})]})]}),(0,a.jsxs)("div",{className:"mb-6 flex items-center justify-between p-4 bg-[#1e1e2e] rounded-lg border border-[#313244]",children:[(0,a.jsxs)("button",{onClick:()=>{B>0&&J(B-1)},disabled:0===B,className:"flex items-center gap-2 px-3 py-2 bg-[#313244] hover:bg-[#45475a] text-[#cdd6f4] rounded-lg transition-colors disabled:opacity-30 disabled:cursor-not-allowed",children:[(0,a.jsx)(m.A,{className:"w-4 h-4"}),"Previous"]}),(0,a.jsxs)("span",{className:"text-sm text-[#a6adc8]",children:[B+1," of ",M.length]}),(0,a.jsxs)("button",{onClick:()=>{B<M.length-1&&J(B+1)},disabled:B===M.length-1,className:"flex items-center gap-2 px-3 py-2 bg-[#313244] hover:bg-[#45475a] text-[#cdd6f4] rounded-lg transition-colors disabled:opacity-30 disabled:cursor-not-allowed",children:["Next",(0,a.jsx)(_.A,{className:"w-4 h-4"})]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-[#cdd6f4] mb-3",children:"Quick Actions:"}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{onClick:()=>{let e=new Map(W);M.forEach(s=>{e.set(s.csvIndex,"update")}),H(e)},className:"flex-1 px-4 py-2 bg-[#313244] hover:bg-[#45475a] text-[#cdd6f4] text-sm font-medium rounded-lg border border-[#45475a] transition-colors",children:"Update All"}),(0,a.jsx)("button",{onClick:()=>{let e=new Map(W);M.forEach(s=>{e.set(s.csvIndex,"skip")}),H(e)},className:"flex-1 px-4 py-2 bg-[#313244] hover:bg-[#45475a] text-[#cdd6f4] text-sm font-medium rounded-lg border border-[#45475a] transition-colors",children:"Skip All"}),(0,a.jsx)("button",{onClick:()=>{let e=new Map(W);M.forEach(s=>{e.set(s.csvIndex,"import")}),H(e)},className:"flex-1 px-4 py-2 bg-[#313244] hover:bg-[#45475a] text-[#cdd6f4] text-sm font-medium rounded-lg border border-[#45475a] transition-colors",children:"Import All"})]})]})]}),4===c&&p&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-6 p-4 bg-[#1e1e2e] rounded-lg border border-[#313244] space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between text-[#cdd6f4]",children:[(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[(0,a.jsx)(k.A,{className:"w-4 h-4 text-green-500"}),"New contacts"]}),(0,a.jsx)("span",{className:"font-semibold",children:p.validRows})]}),(0,a.jsxs)("div",{className:"flex justify-between text-[#6c7086]",children:[(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-lg",children:"⟳"}),"Updated contacts (duplicates)"]}),(0,a.jsx)("span",{children:"0"})]}),(0,a.jsxs)("div",{className:"flex justify-between text-[#6c7086]",children:[(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[(0,a.jsx)(i.A,{className:"w-4 h-4"}),"Skipped (duplicates)"]}),(0,a.jsx)("span",{children:"0"})]}),(0,a.jsxs)("div",{className:"pt-3 border-t border-[#313244] flex justify-between text-[#cdd6f4] font-semibold",children:[(0,a.jsx)("span",{children:"Total from CSV"}),(0,a.jsx)("span",{children:p.totalRows})]})]}),f.length>0&&(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-[#cdd6f4] mb-2",children:"Campaigns:"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:g.filter(e=>f.includes(e.id)).map(e=>(0,a.jsx)("span",{className:"px-3 py-1 bg-[#F25C05]/20 text-[#F25C05] text-sm rounded-full border border-[#F25C05]/30",children:e.name},e.id))})]}),(0,a.jsx)("div",{className:"mb-6 p-4 bg-yellow-500/10 border border-yellow-500/20 rounded-lg",children:(0,a.jsxs)("p",{className:"text-sm text-yellow-400 flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-lg",children:"⚠️"}),"This action will modify your database"]})}),I&&(0,a.jsxs)("div",{className:"mb-4 flex items-center justify-center gap-3",children:[(0,a.jsx)("div",{className:"h-5 w-5 animate-spin rounded-full border-2 border-[#313244] border-t-[#F25C05]"}),(0,a.jsxs)("p",{className:"text-sm text-[#a6adc8]",children:["Importing ",p.validRows," contacts..."]})]}),F&&(0,a.jsx)("div",{className:"mb-4 p-4 bg-red-500/10 border border-red-500/20 rounded-lg",children:(0,a.jsx)("p",{className:"text-sm text-red-400",children:F})})]})]}),(0,a.jsxs)("div",{className:"px-6 py-4 border-t border-[#313244] flex justify-between",children:[(0,a.jsx)("button",{onClick:G,className:"bg-[#313244] hover:bg-[#45475a] text-[#cdd6f4] font-semibold px-4 py-2 rounded-lg border border-[#45475a] transition-all duration-200",children:"Cancel"}),(0,a.jsxs)("div",{className:"flex gap-3",children:[c>1&&c<4&&(0,a.jsxs)("button",{onClick:()=>{2===c?d(1):3===c?d(2):4===c&&(M.length>0?d(3):d(2))},disabled:w,className:"flex items-center gap-2 bg-[#313244] hover:bg-[#45475a] text-[#cdd6f4] font-semibold px-4 py-2 rounded-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,a.jsx)(m.A,{className:"w-4 h-4"}),"Back"]}),1===c&&(0,a.jsxs)("button",{onClick:Q,disabled:!p||w,className:"flex items-center gap-2 bg-[#F25C05] hover:bg-[#D94C04] text-white font-semibold px-4 py-2 rounded-lg shadow-[0_2px_8px_rgba(242,92,5,0.3)] hover:shadow-[0_4px_12px_rgba(242,92,5,0.4)] hover:-translate-y-0.5 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0",children:["Next",(0,a.jsx)(_.A,{className:"w-4 h-4"})]}),2===c&&(0,a.jsxs)("button",{onClick:Q,disabled:0===f.length||w,className:"flex items-center gap-2 bg-[#F25C05] hover:bg-[#D94C04] text-white font-semibold px-4 py-2 rounded-lg shadow-[0_2px_8px_rgba(242,92,5,0.3)] hover:shadow-[0_4px_12px_rgba(242,92,5,0.4)] hover:-translate-y-0.5 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0",children:[w?"Checking...":"Next: Check Duplicates",(0,a.jsx)(_.A,{className:"w-4 h-4"})]}),3===c&&(0,a.jsxs)("button",{onClick:Q,className:"flex items-center gap-2 bg-[#F25C05] hover:bg-[#D94C04] text-white font-semibold px-4 py-2 rounded-lg shadow-[0_2px_8px_rgba(242,92,5,0.3)] hover:shadow-[0_4px_12px_rgba(242,92,5,0.4)] hover:-translate-y-0.5 transition-all duration-200",children:["Next: Confirm Import",(0,a.jsx)(_.A,{className:"w-4 h-4"})]}),4===c&&(0,a.jsx)("button",{onClick:Y,disabled:I,className:"bg-[#F25C05] hover:bg-[#D94C04] text-white font-semibold px-6 py-2 rounded-lg shadow-[0_2px_8px_rgba(242,92,5,0.3)] hover:shadow-[0_4px_12px_rgba(242,92,5,0.4)] hover:-translate-y-0.5 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0",children:I?"Importing...":"Import Contacts"})]})]})]})})}var L=t(41715);function I(e){let{onSearchChange:s,onFilterChange:t,onSortChange:n,campaigns:r=[]}=e,[c,d]=(0,l.useState)("");return(0,l.useEffect)(()=>{let e=setTimeout(()=>{s(c)},300);return()=>clearTimeout(e)},[c,s]),(0,a.jsxs)("div",{className:"mb-6 flex gap-4",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(L.A,{className:"absolute left-4 top-1/2 h-5 w-5 -translate-y-1/2 text-[#7f849c]"}),(0,a.jsx)("input",{type:"text",value:c,onChange:e=>d(e.target.value),placeholder:"Search by name, company, or position...",className:"w-full rounded-lg border border-[#45475a] bg-[#313244] py-3 pl-12 pr-4 text-[#cdd6f4] placeholder-[#6c7086] transition-all duration-200 focus:border-[#F25C05] focus:outline-none focus:ring-1 focus:ring-[#F25C05]"})]}),(0,a.jsxs)("select",{onChange:e=>t(e.target.value),className:"cursor-pointer rounded-lg border border-[#45475a] bg-[#313244] px-4 py-3 text-[#cdd6f4] transition-all duration-200 hover:bg-[#45475a] focus:border-[#F25C05] focus:outline-none focus:ring-1 focus:ring-[#F25C05]",children:[(0,a.jsx)("option",{value:"all",children:"All Contacts"}),(0,a.jsx)("option",{value:"my",children:"My Contacts"}),(0,a.jsx)("option",{value:"unassigned",children:"Unassigned"}),r.map(e=>(0,a.jsx)("option",{value:"campaign-".concat(e.id),children:e.name},e.id))]}),(0,a.jsxs)("select",{onChange:e=>n(e.target.value),defaultValue:"recent",className:"cursor-pointer rounded-lg border border-[#45475a] bg-[#313244] px-4 py-3 text-[#cdd6f4] transition-all duration-200 hover:bg-[#45475a] focus:border-[#F25C05] focus:outline-none focus:ring-1 focus:ring-[#F25C05]",children:[(0,a.jsx)("option",{value:"recent",children:"Recently Added"}),(0,a.jsx)("option",{value:"name-asc",children:"Name A-Z"}),(0,a.jsx)("option",{value:"name-desc",children:"Name Z-A"}),(0,a.jsx)("option",{value:"company",children:"Company A-Z"})]})]})}function E(e){let{contacts:s,loading:t=!1,onViewContact:l}=e;return t?(0,a.jsx)("div",{className:"flex h-64 items-center justify-center rounded-xl border border-[#313244] bg-[#181825] p-6",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,a.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-[#313244] border-t-[#F25C05]"}),(0,a.jsx)("p",{className:"text-sm text-[#a6adc8]",children:"Loading contacts..."})]})}):0===s.length?(0,a.jsx)("div",{className:"flex h-64 items-center justify-center rounded-xl border border-[#313244] bg-[#181825] p-6",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-base text-[#a6adc8]",children:"No contacts found"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-[#6c7086]",children:"Try adjusting your search or filter criteria"})]})}):(0,a.jsx)("div",{className:"overflow-x-auto rounded-xl border border-[#313244] bg-[#181825] p-6",children:(0,a.jsxs)("table",{className:"w-full border-collapse",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-[#313244]",children:[(0,a.jsx)("th",{className:"px-2 py-3 text-left text-xs font-semibold uppercase tracking-wider text-[#7f849c]",children:"Name"}),(0,a.jsx)("th",{className:"px-2 py-3 text-left text-xs font-semibold uppercase tracking-wider text-[#7f849c]",children:"Company"}),(0,a.jsx)("th",{className:"px-2 py-3 text-left text-xs font-semibold uppercase tracking-wider text-[#7f849c]",children:"Campaign(s)"}),(0,a.jsx)("th",{className:"hidden px-2 py-3 text-left text-xs font-semibold uppercase tracking-wider text-[#7f849c] lg:table-cell",children:"Owner"}),(0,a.jsx)("th",{className:"hidden px-2 py-3 text-left text-xs font-semibold uppercase tracking-wider text-[#7f849c] xl:table-cell",children:"Connected On"}),(0,a.jsx)("th",{className:"px-2 py-3 text-right text-xs font-semibold uppercase tracking-wider text-[#7f849c]",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:s.map(e=>{var s;return(0,a.jsxs)("tr",{className:"border-b border-[#313244] transition-colors duration-150 last:border-b-0 hover:bg-[rgba(242,92,5,0.03)]",children:[(0,a.jsx)("td",{className:"px-2 py-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(h,{firstName:e.first_name,lastName:e.last_name}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("button",{onClick:()=>l(e.id),className:"font-bold text-[#cdd6f4] transition-colors duration-200 hover:text-[#F25C05]",children:[e.first_name," ",e.last_name]}),e.position&&(0,a.jsx)("p",{className:"text-sm text-[#6c7086]",children:e.position})]})]})}),(0,a.jsx)("td",{className:"px-2 py-4",children:(0,a.jsx)("span",{className:"text-sm text-[#cdd6f4]",children:e.company||"—"})}),(0,a.jsx)("td",{className:"px-2 py-4",children:(0,a.jsx)(f,{campaigns:e.campaigns})}),(0,a.jsx)("td",{className:"hidden px-2 py-4 lg:table-cell",children:(0,a.jsx)("span",{className:"text-sm text-[#a6adc8]",children:e.owner_id?"Assigned":"Unassigned"})}),(0,a.jsx)("td",{className:"hidden px-2 py-4 xl:table-cell",children:(0,a.jsx)("span",{className:"text-sm text-[#a6adc8]",children:(s=e.connected_on)?new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"—"})}),(0,a.jsx)("td",{className:"px-2 py-4",children:(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)("button",{onClick:()=>l(e.id),className:"rounded-lg p-2 text-[#a6adc8] transition-colors duration-200 hover:bg-[#313244] hover:text-[#F25C05]","aria-label":"View contact",children:(0,a.jsx)(u.A,{className:"h-5 w-5"})}),(0,a.jsx)("button",{onClick:()=>l(e.id),className:"rounded-lg p-2 text-[#a6adc8] transition-colors duration-200 hover:bg-[#313244] hover:text-[#F25C05]","aria-label":"Edit contact",children:(0,a.jsx)(p.A,{className:"h-5 w-5"})})]})})]},e.id)})})]})})}function U(e){var s;let{contact:t,onViewContact:l}=e;return(0,a.jsxs)("div",{className:"rounded-xl border border-[#313244] bg-[#181825] p-4 transition-all duration-200 hover:border-[#45475a]",children:[(0,a.jsxs)("div",{className:"mb-4 flex items-start gap-3",children:[(0,a.jsx)(h,{firstName:t.first_name,lastName:t.last_name,size:"lg"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("button",{onClick:()=>l(t.id),className:"font-bold text-[#cdd6f4] transition-colors duration-200 hover:text-[#F25C05] text-left break-words w-full",children:[t.first_name," ",t.last_name]}),t.position&&(0,a.jsx)("p",{className:"text-sm text-[#6c7086] break-words",children:t.position})]})]}),(0,a.jsxs)("div",{className:"mb-4 space-y-2 border-t border-[#313244] pt-4",children:[t.company&&(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide text-[#7f849c]",children:"Company:"}),(0,a.jsx)("span",{className:"text-sm text-[#cdd6f4]",children:t.company})]}),(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide text-[#7f849c]",children:"Campaign:"}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(f,{campaigns:t.campaigns})})]}),t.connected_on&&(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide text-[#7f849c]",children:"Connected:"}),(0,a.jsx)("span",{className:"text-sm text-[#a6adc8]",children:(s=t.connected_on)?new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"—"})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 border-t border-[#313244] pt-4",children:[(0,a.jsxs)("button",{onClick:()=>l(t.id),className:"flex flex-1 items-center justify-center gap-2 rounded-lg bg-[#313244] px-3 py-2.5 text-sm font-medium text-[#cdd6f4] transition-all duration-200 hover:bg-[#45475a] hover:text-[#F25C05] active:scale-95","aria-label":"View contact",children:[(0,a.jsx)(u.A,{className:"h-5 w-5"}),"View"]}),(0,a.jsxs)("button",{onClick:()=>l(t.id),className:"flex flex-1 items-center justify-center gap-2 rounded-lg bg-[#313244] px-3 py-2.5 text-sm font-medium text-[#cdd6f4] transition-all duration-200 hover:bg-[#45475a] hover:text-[#F25C05] active:scale-95","aria-label":"Edit contact",children:[(0,a.jsx)(p.A,{className:"h-5 w-5"}),"Edit"]})]})]})}function O(){let[e,s]=(0,l.useState)(!1),[t,c]=(0,l.useState)(!1),[d,i]=(0,l.useState)(!1),[o,x]=(0,l.useState)(null),[m,p]=(0,l.useState)([]),[b,u]=(0,l.useState)([]),[h,f]=(0,l.useState)(!0),[g,N]=(0,l.useState)(null),[y,w]=(0,l.useState)(""),[k,_]=(0,l.useState)("all"),[F,S]=(0,l.useState)("recent"),{showToast:A}=(0,j.d)(),L=(0,l.useCallback)(async()=>{try{f(!0),N(null);let e=new URLSearchParams({search:y,filter:k,sort:F}),s=await fetch("/api/contacts?".concat(e));if(!s.ok)throw Error("Failed to fetch contacts");let t=await s.json();p(t.contacts)}catch(e){console.error("Error fetching contacts:",e),N("Failed to load contacts. Please try again."),A("Failed to load contacts","error")}finally{f(!1)}},[y,k,F,A]),O=(0,l.useCallback)(async()=>{try{let e=await fetch("/api/campaigns");if(e.ok){let s=await e.json();u(s.campaigns)}}catch(e){console.error("Error fetching campaigns:",e)}},[]);(0,l.useEffect)(()=>{L(),O()},[L,O]);let P=e=>{x(e),c(!0)};return(0,a.jsxs)("div",{className:"max-w-[1200px]",children:[(0,a.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-[#cdd6f4]",children:"Contacts"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-[#a6adc8]",children:"Manage your LinkedIn connections and leads"})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)("button",{onClick:()=>{i(!0)},className:"flex items-center gap-2 rounded-lg border border-[#313244] bg-transparent px-4 py-2 text-sm font-medium text-[#cdd6f4] transition-colors duration-200 hover:bg-[#313244] hover:border-[#45475a] focus:outline-none focus:ring-2 focus:ring-[#F25C05] focus:ring-offset-2 focus:ring-offset-[#1e1e2e]",children:[(0,a.jsx)(n.A,{className:"h-5 w-5"}),"Upload CSV"]}),(0,a.jsxs)("button",{onClick:()=>{s(!0)},className:"flex items-center gap-2 rounded-lg bg-[#F25C05] px-4 py-2 text-sm font-medium text-white transition-colors duration-200 hover:bg-[#ff6b1a] focus:outline-none focus:ring-2 focus:ring-[#F25C05] focus:ring-offset-2 focus:ring-offset-[#1e1e2e]",children:[(0,a.jsx)(r.A,{className:"h-5 w-5"}),"New Contact"]})]})]}),(0,a.jsx)(I,{onSearchChange:e=>{w(e)},onFilterChange:e=>{_(e)},onSortChange:e=>{S(e)},campaigns:b}),g&&(0,a.jsx)("div",{className:"mb-6 rounded-lg border border-red-500/20 bg-red-500/10 p-4",children:(0,a.jsx)("p",{className:"text-sm text-red-400",children:g})}),(0,a.jsx)("div",{className:"hidden md:block",children:(0,a.jsx)(E,{contacts:m,loading:h,onViewContact:P})}),(0,a.jsx)("div",{className:"md:hidden",children:h?(0,a.jsx)("div",{className:"flex h-64 items-center justify-center",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,a.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-[#313244] border-t-[#F25C05]"}),(0,a.jsx)("p",{className:"text-sm text-[#a6adc8]",children:"Loading contacts..."})]})}):0===m.length?(0,a.jsx)("div",{className:"flex h-64 items-center justify-center rounded-xl border border-[#313244] bg-[#181825] p-6",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-base text-[#a6adc8]",children:"No contacts found"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-[#6c7086]",children:"Try adjusting your search or filter criteria"})]})}):(0,a.jsx)("div",{className:"space-y-4",children:m.map(e=>(0,a.jsx)(U,{contact:e,onViewContact:P},e.id))})}),(0,a.jsx)(C,{isOpen:e,onClose:()=>{s(!1)},onSuccess:()=>{A("Contact created successfully!","success"),s(!1),L()}}),o&&(0,a.jsx)(v,{contactId:o,isOpen:t,onClose:()=>{c(!1),x(null)},onContactUpdated:()=>{L()},onContactDeleted:()=>{L()}}),(0,a.jsx)(D,{isOpen:d,onClose:()=>{i(!1)},onSuccess:()=>{A("Contacts imported successfully!","success"),i(!1),L()}})]})}}},e=>{e.O(0,[3359,2490,2350,8441,1255,7358],()=>e(e.s=27395)),_N_E=e.O()}]);